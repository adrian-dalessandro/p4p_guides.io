<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Organization Directory</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>

<header class="navbar is-dark mb-4">
    <div class="container">
      <div class="navbar-brand">
        <h1 class="navbar-item title is-4 has-text-white" style="font-family: 'Roboto', sans-serif; ">
          <span>Parents for Palestine</span>
        </h1>
        <a href="https://www.instagram.com/YOUR_INSTAGRAM_PAGE" target="_blank" class="navbar-item has-text-white">
          <i class="fab fa-instagram" style="font-size: 1.5rem;"></i>
        </a>
      </div>
    </div>
  </header>
    <section class="section">
        <div class="container">
          <h2 class="title is-5" style="font-family: 'Roboto', sans-serif; text-align: left;">
            Welcome to the Vancouver Ethical Buyers Guide 2024/2025
          </h2>
          <p class="subtitle is-6 has-text-left">
            This guide features businesses we have relationships with, those that have supported us, or those we are aware of and believe align with our values. It is not an exhaustive list but a reflection of the connections and trust we’ve built within the local Vancouver community.
            Importantly, we are prioritizing and amplifying businesses that have taken a stand against injustice, particularly those actively opposing the genocide in Gaza and showing solidarity with Palestinians. By supporting these businesses, we aim to uphold values of justice, human rights, and ethical responsibility.
            If you know of a business that shares these values and deserves to be included, please reach out to us. Let’s continue to build a stronger, more compassionate network together.

          </p>
        </div>
      </section>
  <main class="container">
    <section>
  <div id="organization-container" class="columns is-multiline">
    <p class="has-text-centered column is-12">Loading data...</p>
  </div>
</section>

<script>
  const SHEET_URL = "https://docs.google.com/spreadsheets/d/16AEH1MtzrZ-OQGR9r9UQR2eiO8QkpsT4Je0n_EAi_ac/gviz/tq?tqx=out:csv";

  const fetchGoogleSheetData = async () => {
  try {
    const response = await fetch(SHEET_URL);
    const csvText = await response.text();
    const data = csvText
      .split("\n")
      .map((row) => row.split(",").map((cell) => cell.replace(/^"|"$/g, ""))); // Remove quotes
    return data;
  } catch (error) {
    console.error("Error fetching Google Sheet data:", error);
  }
};

  const renderOrganizations = async () => {
    const container = document.getElementById("organization-container");
    container.innerHTML = "";
    const data = await fetchGoogleSheetData();

    if (!data || data.length < 2) {
      container.innerHTML = `<p class="has-text-centered has-text-danger">Failed to load data.</p>`;
      return;
    }

    const [headers, ...rows] = data;
    const categories = {};
    rows.forEach(([orgName, website, category, description]) => {
      if (!categories[category]) categories[category] = [];
      categories[category].push({ orgName, website, description });
    });

    Object.entries(categories).forEach(([category, items]) => {
      const categorySection = document.createElement("section");
      categorySection.classList.add("column", "is-12", "mb-6");

      const categoryTitle = `<h2 class="title is-4">${category}</h2>`;
      const cards = items
        .map(
          ({ orgName, website, description }) => `
          <div class="card mb-4" style="padding: 1rem; width: 100%;">
            <div class="card-content">
              <p class="title is-5">${orgName}</p>
              ${website ? `<p><a href="${website}" target="_blank">${website}</a></p>` : ""}
              <p class="content">${description}</p>
            </div>
          </div>
        `
        )
        .join("");

      categorySection.innerHTML = `${categoryTitle}${cards}`;
      container.appendChild(categorySection);
    });
  };

  renderOrganizations();
</script>

  </main>
  <footer class="footer has-background-light mt-6">
  </footer>
</body>
</html>